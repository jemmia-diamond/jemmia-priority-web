<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-S7Q7M2B9DJ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-S7Q7M2B9DJ");
    </script>
    <!-- Mobile Specific Metas -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, viewport-fit=cover"
    />
    <title>Jemmia Priority - Thông tin hạng</title>
    <!-- Favicon and Touch Icons  -->
    <link rel="shortcut icon" href="images/logo.png" />
    <link rel="apple-touch-icon-precomposed" href="images/logo.png" />
    <!-- Font -->
    <link rel="stylesheet" href="fonts/fonts.css" />
    <!-- Icons -->
    <link rel="stylesheet" href="fonts/icons-alipay.css" />
    <link rel="stylesheet" href="styles/bootstrap.css" />

    <link rel="stylesheet" type="text/css" href="styles/styles.css" />
    <link
      rel="manifest"
      href="_manifest.json"
      data-pwa-version="set_in_manifest_and_pwa_js"
    />
    <link
      rel="apple-touch-icon"
      sizes="192x192"
      href="app/icon/icon-192x192.jpg"
    />
  </head>

  <body class="" id="bg_gradient" style="background-color: #f5f5f5">
    <!-- preloade -->

    <!-- /preload -->
    <div class="header is-fixed">
      <div class="tf-container">
        <div
          class="tf-statusbar d-flex justify-content-center align-items-center"
        >
          <a style="outline: none" href="#" class="back-btn">
            <i class="icon-left"></i>
          </a>
          <h3>Thông tin hạng</h3>
          <!-- <a href="#" id="btn-popup-up" class="action-right"><i class="icon icon-filter"></i> </a> -->
        </div>
      </div>
    </div>

    <div class="tf-container" style="margin-top: 55px">
      <div
        class="tf-balance-box"
        id="bg_card"
        style="
          background-position: center;
          background-size: cover;
          background-color: transparent;
        "
      >
        <div class="balance">
          <div class="row text-white">
            <div class="col-12" style="height: 100px">
              <img
                style="opacity: 0"
                hidden
                src="images/background/platinum.png"
                alt=""
              />
            </div>
            <div class="col-6 br-right pt-3">
              <div class="inner-left">
                <h3
                  style="color: white"
                  id="full_name"
                  class="gradient-text"
                ></h3>
                <div class="d-flex gap-1">
                  <p class="gradient-text">Hạng</p>
                  <p class="gradient-text" id="rank_name"></p>
                </div>
              </div>
            </div>
            <div class="col-6 pt-3">
              <div class="inner-right">
                <p style="color: white">Điểm thưởng</p>
                <div
                  class="d-flex align-items-center gap-1 justify-content-end"
                  style="color: white"
                >
                  <img
                    class="mx-1"
                    style="width: 7%"
                    src="./images/Vector.svg"
                    alt=""
                  />
                  <p id="point" class="text-white fw-bold"></p>
                  <span>Points</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- <div class="wallet-footer">
                <ul class="d-flex justify-content-between align-items-center ">
                    <li class="wallet-card-item">
                        <a class="fw_6 text-center " id="btn-popup-down">
                            <ul class="icon icon-group-transfers">
                                <li class="path1"></li>
                                <li class="path2"></li>
                                <li class="path3"></li>
                            </ul>
                           Tích Điểm
                        </a>
                    </li>
                    <li class="wallet-card-item"><a class="fw_6 " href="29_topup.html">
                            <ul class="icon icon-topup">
                                <li class="path1"></li>
                                <li class="path2"></li>
                                <li class="path3"></li>
                                <li class="path4"></li>
                            </ul>
                            Đổi Thưởng
                        </a></li>
                    <li class="wallet-card-item"><a class="fw_6 btn-card-popup " href="#">
                            <ul class="icon icon-group-credit-card ">
                                <li class="path1"></li>
                                <li class="path2"></li>
                                <li class="path3"></li>
                            </ul>
                            Đặt Hàng
                        </a></li>
                    <li class="wallet-card-item"><a class="fw_6" href="40_qr-code.html">
                            <ul class="icon icon-my-qr">
                                <li class="path1"></li>
                                <li class="path2"></li>
                                <li class="path3"></li>
                                <li class="path4"></li>
                                <li class="path5"></li>
                                <li class="path6"></li>
                                <li class="path7"></li>
                            </ul>
                            Liên Hệ
                        </a></li>
                </ul>
            </div> -->
      </div>
    </div>

    <div class="tf-container mt-1">
      <ul class="bank-list-transfer">
        <a
          href="68_gift-card-detail.html?id=48&name=uu_dai_thang"
          style="outline: none"
          class="d-flex justify-content-between"
        >
          <!-- id="btn-popup-down" -->
          <p>Chính sách khách hàng</p>
          <p class="text-end">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="20"
              style="color: #000000"
              fill="currentColor"
              class="bi bi-chevron-right"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"
              />
            </svg>
          </p>
        </a>
      </ul>
      <div class="tf-panel down">
        <div class="panel_overlay"></div>
        <div class="panel-box panel-down">
          <div class="header bg_white_color">
            <div class="tf-container">
              <div class="tf-statusbar d-flex px-5 align-items-center">
                <a style="outline: none" href="#" class="clear-panel">
                  <i class="icon-close1"></i>
                </a>
                <h3></h3>
              </div>
            </div>
          </div>
          <div class="panel-content mb-5 mt-5">
            <div class="tf-container">
              <h2 class="pb-2">Privacy</h2>
              <p>
                A mobile app privacy policy is a legal statement that must be
                clear, conspicuous, and consented to by all users. It must
                disclose how a mobile app gathers, stores, and uses the
                personally identifiable information it collects from its users.
                A mobile privacy app is developed and presented to users so that
                mobile app developers stay compliant with state, federal, and
                international laws. As a result, they fulfill the legal
                requirement to safeguard user privacy while protecting the
                company itself from legal challenges.
              </p>
            </div>
            <div class="tf-container pt-3">
              <h2 class="pb-2">Authorized Users</h2>
              <p>
                A mobile app privacy policy is a legal statement that must be
                clear, conspicuous, and consented to by all users. It must
                disclose how a mobile app gathers, stores, and uses the
                personally identifiable information it collects from its users.
              </p>
            </div>
            <div class="mt-5">
              <div class="tf-container">
                <div class="group-checkbox mt-3 pb-3">
                  <input type="checkbox" class="tf-checkbox st1" />
                  <span class="fw_3"
                    >Save this account number to transfer money later</span
                  >
                </div>
                <button
                  type="submit"
                  id=""
                  class="tf-btn accent large clear-panel"
                  data-bs-dismiss="modal"
                >
                  I Accept
                </button>
              </div>
            </div>
          </div>
          <!--  -->
        </div>
      </div>
    </div>
    <!--  -->
    <div class="tf-container mt-1">
      <ul class="bank-list-transfer2" id="maintain2">
        <li class="d-flex flex-column gap-1">
          <p>Giá trị đơn hàng tích lũy</p>
          <p class="fw-bold" id="points"></p>
        </li>
      </ul>
    </div>

    <div class="tf-container mt-1">
      <ul class="bank-list-transfer2" id="maintain">
        <!--  -->
        <li class="outline d-flex flex-column gap-1 py-1">
          <p class="fw-bold fs-6" style="color: black">
            Để nâng hạng thẻ cao hơn
          </p>
          <p class=" " id="statistics_2"></p>
        </li>
        <!--  -->
        <!-- <li class="outline d-flex flex-column gap-1 py-1">
          <p class="fw-bold fs-6" style="color: black" id="maintain">
            Để duy trì hạn thẻ
          </p>
          <p class=" " id="statistics"></p>
        </li> -->
      </ul>
    </div>

    <div class="tf-panel up">
      <div class="panel_overlay"></div>
      <div class="panel-box panel-up wrap-panel-clear panel-change-profile">
        <div class="heading">
          <a href="#">Show Profile Picture</a>
          <a href="#">New Photo Shoot</a>
          <a href="#">Select Photo Form Device</a>
          <a href="#">Choose An Existing Avatar</a>
        </div>
        <div class="bottom">
          <a class="clear-panel" href="#">Dismiss</a>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="javascript/bootstrap.min.js"></script>
    <script type="text/javascript" src="javascript/jquery.min.js"></script>
    <script type="text/javascript" src="javascript/main.js"></script>
    <script src="./javascript/profile.js"></script>
    <script>
      const tokens = JSON.parse(localStorage.getItem("accessToken"));
      const data_user2 = JSON.parse(localStorage.getItem("user"));
      const HEADER = {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + tokens,
        },
      };
      const data = fetch(
        "https://priority-api.jemmia.vn/customer-rank/rank-info",
        HEADER
      ).then((item) => {
        item.json().then((items) => {
          console.log(items);

          var dateString = items.rankExpirationTime;
          var date = new Date(dateString);
          var minutes = date.getMinutes();
          var hours = date.getHours();
          var day = date.getDate();
          var month = date.getMonth() + 1; // Ghi chú: Tháng bắt đầu từ 0, nên cần cộng 1
          var year = date.getFullYear();
          var formattedDate = `${day > 9 ? day : `0${day}`}/${
            month > 9 ? month : `0${month}`
          }/${year}`;

          if (items.currentRank.name != "silver") {
            const maintain2 = document.getElementById("maintain2");
            const listItem = document.createElement("li");
            listItem.classList.add(
              "d-flex",
              "flex-column",
              "gap-1",
              "border-top",
              "pt-2"
            );

            if (items.rankExpirationTime) {
              const currentRankingParagraph = document.createElement("p");
              currentRankingParagraph.textContent = "Kỳ xét hạng hiện tại";
              const dateEndParagraph = document.createElement("p");
              dateEndParagraph.classList.add("fw-bold");
              dateEndParagraph.id = "dateEnd";
              dateEndParagraph.innerText = items.rankExpirationTime
                ? formattedDate
                : "";

              // Thêm các phần tử vào listItem
              listItem.appendChild(currentRankingParagraph);

              listItem.appendChild(dateEndParagraph);
              maintain2.append(listItem);
            }
          }
          // const dates = (document.getElementById("dateEnd").innerText =
          //   items.rankExpirationTime ? formattedDate : "");

          if (items.currentRank.name != "silver") {
            const maintain = document.getElementById("maintain");
            const listItem = document.createElement("li");
            listItem.classList.add(
              "outline",
              "d-flex",
              "flex-column",
              "gap-1",
              "py-1",
              "border-top"
            );

            const maintainParagraph = document.createElement("p");
            const maintainParagraph2 = document.createElement("p");

            maintainParagraph.classList.add("fw-bold", "fs-6");
            maintainParagraph.style.color = "black";
            maintainParagraph.id = "maintain";
            maintainParagraph.textContent = "Để duy trì hạn thẻ";

            const statisticsParagraph = document.createElement("p");
            // statisticsParagraph.classList.add("");
            statisticsParagraph.id = "statistics";
            statisticsParagraph.innerHTML = dateString
              ? `Đến ngày ${formattedDate} cần ${Math.floor(
                  items.pointNeed.buyPoint
                ).toLocaleString("vi-VN")} điểm hoặc ${Math.floor(
                  items.pointNeed.refPoint
                ).toLocaleString(
                  "vi-VN"
                )} điểm để duy trì hạng <span class="text-capitalize">${
                  items.nextRank.name
                }</span>`
              : `Cần ${Math.floor(items.pointNeed.buyPoint).toLocaleString(
                  "vi-VN"
                )} điểm để duy trì hạng <span class="text-capitalize">${
                  items.nextRank.name
                }</span> `;

            // Thêm các phần tử vào listItem
            listItem.appendChild(maintainParagraph);
            listItem.appendChild(statisticsParagraph);

            maintain.appendChild(listItem);
          } else {
          }

          const Statistics_2 = (document.getElementById(
            "statistics_2"
          ).innerHTML = dateString
            ? `Đến ngày ${formattedDate} cần ${Math.floor(
                items.nextRank.buyPoint
              ).toLocaleString("vi-VN")} điểm hoặc ${Math.floor(
                items.nextRank.refPoint
              ).toLocaleString(
                "vi-VN"
              )} điểm để lên hạng <span class="text-capitalize">${
                items.nextRank.name
              }</span>`
            : `Cần ${Math.floor(items.nextRank.buyPoint).toLocaleString(
                "vi-VN"
              )} điểm để lên hạng <span class="text-capitalize">${
                items.nextRank.name
              }</span>`);
          const points = (document.getElementById(
            "points"
          ).innerText = `${Math.floor(
            data_user2?.accumulatedOrderPoint
          ).toLocaleString("vi-VN")} đ`);
        });
      });
    </script>
  </body>
</html>
